# フェーズ 3: DSL とディスカバリー タスクリスト

> [!IMPORTANT]
> **テスト要件**: 各チェックリスト項目は、関連するテスト（既存または新規追加）がパスしたことを確認してから完了とし、次の項目に進んでください。

## 1. 分岐ロジック (`dsl/syntax.py`, `core/engine.py`)
- [x] **OR (`|`) のDSLサポート**
    - [x] `TaskWrapper.__or__` が分岐を表す構造を正しく構築することを確認する。
    - [x] `Flow` グラフにおいて `|` が `&` とどう異なるか（例: 条件付きエッジや特定のノードタイプ）を定義する。
- [x] **ランタイムでの分岐選択**
    - [x] どの分岐に進むかを決定するロジックを実装する。
    - [x] *注: 仕様では条件定義が曖昧です。条件が前のタスクの出力の一部か、別のロジックかを決定する必要があります。*
    - [x] MVP向け: 「OR-join」動作（*いずれか*の依存関係を待つ？）または単純な条件付きスキップを実装する。

## 2. ディスカバリーの競合解決 (`discovery/loader.py`)
- [x] **優先順位ルールの実装**
    - [x] `config.tasks`（明示的）からのタスクを最初に読み込むか、高優先度としてマークする。
    - [x] パッケージ/モジュールから読み込む際、タスク名が既に存在するか確認する。
    - [x] 存在し、かつ明示的な場合はスキップ/警告する。
    - [x] 存在し、かつ暗黙的（別のパッケージ由来）な場合は、`--strict` ならエラー、そうでなければ警告ログを出力する。
- [x] **Strict モード**
    - [x] `TaskLoader` に `strict: bool` フラグを追加する。
    - [x] Strict モードでの名前衝突時に `AmbiguousTaskError` を発生させる。

## 3. Glob モジュール (`discovery/loader.py`)
- [x] **Glob 展開の実装**
    - [x] `TaskLoader.load()` で `config.discovery.glob_modules` を反復処理する。
    - [x] `glob` モジュールを使用して一致するファイル/モジュールを検索する。
    - [x] ファイルパスをモジュールパス（ドット区切り）に変換する。
    - [x] 発見されたモジュールをインポートしてスキャンする。
