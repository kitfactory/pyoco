# v0.3.0 Implementation Tasks

## 1. Kanban Server (FastAPI)
- [x] Create `src/pyoco/server` package
- [x] Implement `StateStore` (in-memory)
    - [x] `runs` dict: `run_id` -> `RunContext`
    - [x] `queue` list: `[run_id, ...]`
- [x] Implement API Endpoints
    - [x] `POST /runs`: Submit flow (returns `run_id`)
    - [x] `GET /runs`: List runs
    - [x] `GET /runs/{run_id}`: Get run details
    - [x] `POST /runs/{run_id}/cancel`: Request cancellation
    - [x] `POST /workers/poll`: Worker polling endpoint
    - [x] `POST /runs/{run_id}/heartbeat`: Worker heartbeat/update

## 2. Worker Implementation
- [x] Create `src/pyoco/worker` package
- [x] Implement `Worker` class
    - [x] Polling loop (poll -> execute -> repeat)
    - [x] Integration with `Engine` (reuse existing engine)
    - [x] Heartbeat mechanism (send task states to server)
    - [x] Cancellation handling (check server response during heartbeat)

## 3. CLI Updates
- [x] Add `pyoco server start` command
- [x] Add `pyoco worker start` command
- [x] Add `pyoco runs` subcommand group (`list`, `show`, `cancel`)
- [x] Update `pyoco run` to support `--server` (remote submission)

## 4. Verification
- [x] Unit tests for Server API
- [x] Unit tests for Worker logic (Covered by integration)
- [x] Integration test: Full flow (Submit -> Queue -> Worker -> Success)
